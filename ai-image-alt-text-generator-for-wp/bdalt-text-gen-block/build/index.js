(()=>{"use strict";const e=window.React,t=window.wp.hooks,n=e=>"number"==typeof e&&!isNaN(e),o=e=>"string"==typeof e,a=e=>"function"==typeof e,r=t=>(0,e.isValidElement)(t)||o(t)||a(t)||n(t);function i(t){let{enter:n,exit:o,appendPosition:a=!1,collapse:r=!0,collapseDuration:i=300}=t;return function(t){let{children:s,position:l,preventExitTransition:c,done:d,nodeRef:u,isIn:g,playToast:m}=t;const p=a?`${n}--${l}`:n,f=a?`${o}--${l}`:o,b=(0,e.useRef)(0);return(0,e.useLayoutEffect)((()=>{const e=u.current,t=p.split(" "),n=o=>{o.target===u.current&&(m(),e.removeEventListener("animationend",n),e.removeEventListener("animationcancel",n),0===b.current&&"animationcancel"!==o.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",n),e.addEventListener("animationcancel",n)}),[]),(0,e.useEffect)((()=>{const e=u.current,t=()=>{e.removeEventListener("animationend",t),r?function(e,t,n){void 0===n&&(n=300);const{scrollHeight:o,style:a}=e;requestAnimationFrame((()=>{a.minHeight="initial",a.height=o+"px",a.transition=`all ${n}ms`,requestAnimationFrame((()=>{a.height="0",a.padding="0",a.margin="0",setTimeout(t,n)}))}))}(e,d,i):d()};g||(c?t():(b.current=1,e.className+=` ${f}`,e.addEventListener("animationend",t)))}),[g]),e.createElement(e.Fragment,null,s)}}const s=new Map;let l=[];const c=new Set,d=()=>s.size>0;function u(e,t){s.forEach((n=>{null!=t&&null!=t&&t.containerId?(null==t?void 0:t.containerId)===n.id&&n.toggle(e,null==t?void 0:t.id):n.toggle(e,null==t?void 0:t.id)}))}let g=1;const m=()=>""+g++;function p(e){return e&&(o(e.toastId)||n(e.toastId))?e.toastId:m()}function f(e,t){return function(e,t){r(e)&&(d()||l.push({content:e,options:t}),s.forEach((n=>{n.buildToast(e,t)})))}(e,t),t.toastId}function b(e,t){return{...t,type:t&&t.type||e,toastId:p(t)}}function _(e){return(t,n)=>f(t,b(e,n))}function h(e,t){return f(e,b("default",t))}h.loading=(e,t)=>f(e,b("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),h.promise=function(e,t,n){let r,{pending:i,error:s,success:l}=t;i&&(r=o(i)?h.loading(i,n):h.loading(i.render,{...n,...i}));const c={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},d=(e,t,a)=>{if(null==t)return void h.dismiss(r);const i={type:e,...c,...n,data:a},s=o(t)?{render:t}:t;return r?h.update(r,{...i,...s}):h(s.render,{...i,...s}),a},u=a(e)?e():e;return u.then((e=>d("success",l,e))).catch((e=>d("error",s,e))),u},h.success=_("success"),h.info=_("info"),h.error=_("error"),h.warning=_("warning"),h.warn=h.warning,h.dark=(e,t)=>f(e,b("default",{theme:"dark",...t})),h.dismiss=function(e){!function(e){var t;if(d()){if(null==e||o(t=e)||n(t))s.forEach((t=>{t.removeToast(e)}));else if(e&&("containerId"in e||"id"in e)){const t=s.get(e.containerId);t?t.removeToast(e.id):s.forEach((t=>{t.removeToast(e.id)}))}}else l=l.filter((t=>null!=e&&t.options.toastId!==e))}(e)},h.clearWaitingQueue=function(e){void 0===e&&(e={}),s.forEach((t=>{!t.props.limit||e.containerId&&t.id!==e.containerId||t.clearQueue()}))},h.isActive=function(e,t){var n;if(t)return!(null==(n=s.get(t))||!n.isToastActive(e));let o=!1;return s.forEach((t=>{t.isToastActive(e)&&(o=!0)})),o},h.update=function(e,t){void 0===t&&(t={});const n=((e,t)=>{var n;let{containerId:o}=t;return null==(n=s.get(o||1))?void 0:n.toasts.get(e)})(e,t);if(n){const{props:o,content:a}=n,r={delay:100,...o,...t,toastId:t.toastId||e,updateId:m()};r.toastId!==e&&(r.staleId=e);const i=r.render||a;delete r.render,f(i,r)}},h.done=e=>{h.update(e,{progress:1})},h.onChange=function(e){return c.add(e),()=>{c.delete(e)}},h.play=e=>u(!0,e),h.pause=e=>u(!1,e),"undefined"!=typeof window?e.useLayoutEffect:e.useEffect;const w=function(e,t){return void 0===t&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}};i(w("bounce",!0)),i(w("slide",!0)),i(w("zoom")),i(w("flip"));const y=window.wp.compose,v=window.wp.blockEditor,E=window.wp.components,k=window.wp.i18n;function x(t){const[n,o]=(0,e.useState)(!1),[a,r]=(0,e.useState)(!1),[i,s]=(0,e.useState)(""),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(""),[g,m]=(0,e.useState)(!1);return(0,e.createElement)(v.InspectorControls,null,(0,e.createElement)(E.PanelBody,{title:(0,k.__)("AI ALT TEXT","ai-image-alt-text-generator-for-wp")},(0,e.createElement)(E.PanelRow,null,(0,e.createElement)("div",{class:"bdai_alt_text_gutenburg_generator"},(0,e.createElement)("div",{class:"bdaiatg_alt_text_gutenburg_generator_content"},(0,e.createElement)("p",null,"Populate alt text using values from your media library images. If missing, alt text will be generated for an image and added to the post."),(0,e.createElement)("div",{class:"bdaiatg_alt_text_gutenburg_generator_content_checkbox"},(0,e.createElement)("input",{onChange:()=>r((e=>!e)),type:"checkbox",id:"bdaiatg-generate-button-overwrite-checkbox"}),(0,e.createElement)("label",{for:"bdaiatg-generate-button-overwrite-checkbox"},"Overwrite existing alt text")),(0,e.createElement)("div",{class:"bdaiatg_alt_text_gutenburg_generator_content_checkbox"},(0,e.createElement)("input",{type:"checkbox",id:"bdaiatg-generate-button-focus-keywords-checkbox",style:{marginRight:"10px"},onChange:e=>{const t=window.import_csv.focus_keyword;e.target.checked?(u(t),m(!0)):(u(""),m(!1))}}),(0,e.createElement)("label",{for:"bdaiatg-generate-button-focus-keywords-checkbox"},"Add SEO Focus keywords"),(0,e.createElement)("br",null),""===window.import_csv.focus_keyword&&g&&(0,e.createElement)("p",{style:{marginTop:"10px",color:"red"}},"Focus keyword is empty! Set the SEO keyword before adding the focus keyword, save the post, reload the page, and then generate it.")),(0,e.createElement)("div",{class:"bdaiatg_alt_text_gutenburg_generator_content_checkbox"},(0,e.createElement)("input",{type:"checkbox",id:"bdaiatg-generate-button-keywords-checkbox",onChange:()=>o(!n)}),(0,e.createElement)("label",{for:"bdaiatg-generate-button-keywords-checkbox"},"Add SEO keywords"),n&&(0,e.createElement)("input",{type:"text",id:"bdaiatg-generate-button-keywords-seo",onChange:e=>{s(e.target.value)},placeholder:"keyword1, keyword2"})),(0,e.createElement)("div",{id:"bdaiatg_alt_text_gen_btn"},(0,e.createElement)("button",{onClick:()=>(()=>{if(c(!0),""!==t.attributes.alt&&!a)return jQuery.toast({heading:"Warning",text:(0,k.__)("This image has already alt text if you want to override please checked the Overwrite existing alt text","ai-image-alt-text-generator-for-wp"),showHideTransition:"fade",bgColor:"#DD6B20",loader:!1,icon:"warning",allowToastClose:!1,position:{right:80,top:60}}),c(!1),!1;const e=document.getElementById("post_ID")?.value;var n;jQuery.ajax({type:"post",dataType:"json",url:import_csv.ajaxurl,data:{action:"bulk_alt_image_generator_gutenburg_block",nonce:import_csv.nonce,post_id:e,attachment_id:t.attributes.id,attachment:t.attributes.url,focus_keyword:d,keywords:(n=i,n.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0})).slice(0,6)),overrite_existing_image:a},success:function(e){!0===e.success&&(t.setAttributes({alt:e.data.text}),document.querySelector(".editor-post-publish-button__button").click(),jQuery.toast({heading:"Success",text:e.data.message,showHideTransition:"fade",bgColor:"#38A169",loader:!1,icon:"success",allowToastClose:!1,position:{right:80,top:60}})),!1===e.success&&e.data.status&&"error"===e.data.status&&(window.location.href=e.data.redirect_url),c(!1)},error:function(e){console.log(e),c(!1)}})})()},l?(0,e.createElement)("div",{className:"loader"}):(0,e.createElement)("span",null,"Generate Alt Text")))))),"custom_field"===t.attributes.isPostLink&&(0,e.createElement)(E.PanelRow,null,(0,e.createElement)(E.TextControl,{label:(0,k.__)("Custom field name"),value:t.attributes.customFieldName,onChange:e=>{t.setAttributes({customFieldName:e})},help:(0,k.__)("The name of the custom field to link to.","ai-image-alt-text-generator-for-wp")}))))}(0,t.addFilter)("blocks.registerBlockType","bdaitgen/override_core_img",(function(e,t){return"core/image"!==t?e:{...e,attributes:{...e.attributes,isPostLink:{type:"string",default:""},customFieldName:{type:"string",default:""}}}})),(0,t.addFilter)("editor.BlockEdit","bdaitgen/override_core_img",(0,y.createHigherOrderComponent)((t=>n=>"core/image"!==n.name?(0,e.createElement)(t,{...n}):(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t,{...n}),(0,e.createElement)(x,{...n})))))})();